<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ titulo }} | Distribuidora JS</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --color-principal: #1a5276;
            --color-secundario: #5499c7;
            --color-contraste: #f39c12;
            --color-fondo: #f8f9fa;
            --color-texto: #333;
            --color-borde: #e0e0e0;
            --footer-bg: #0f1720;
            --footer-accent: #0ea5a4;
            --footer-text: #e6eef2;
        }

        body { font-family: 'Poppins', sans-serif; margin: 0; background-color: var(--color-fondo); color: var(--color-texto); line-height: 1.6; }
        .header { background-color: var(--color-principal); color: white; padding: 25px 40px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); }
        .header h1 { margin: 0; font-weight: 600; font-size: 1.8em; }
        .nav a { color: #f4f4f4; margin-right: 25px; text-decoration: none; padding: 10px 15px; border-radius: 6px; transition: background-color 0.3s; font-weight: 400; }
        .nav a:hover { background-color: #34495e; }
        .container { max-width: 1300px; margin: 30px auto; padding: 30px; background: white; border-radius: 15px; box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1); }
        h2 { color: var(--color-principal); border-bottom: 2px solid var(--color-secundario); padding-bottom: 10px; margin-top: 0; font-weight: 600; }

        /* Estilos de Botones y Formularios */
        .btn-action { background-color: var(--color-contraste); color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; transition: background-color 0.3s; }
        .btn-action:hover { background-color: #e67e22; }

        /* Estilos de Tablas Generales */
        .data-table { width: 100%; border-collapse: separate; border-spacing: 0; margin-top: 20px; }
        .data-table th, .data-table td { padding: 12px; text-align: left; border-bottom: 1px solid var(--color-borde); }
        .data-table th { background-color: var(--color-principal); color: white; font-weight: 600; }
        .data-table tbody tr:hover { background-color: #f0f8ff; cursor: pointer; }

        /* Estilos para Contenido Espec√≠fico */
        .registration-area input, .registration-area select, .registration-area textarea {
            border: 1px solid var(--color-borde);
            padding: 10px;
            border-radius: 4px;
            width: 100%;
            box-sizing: border-box;
            margin-top: 5px;
        }

        /* FOOTER: dise√±o moderno e interactivo */
        .site-footer {
            background: linear-gradient(180deg, var(--footer-bg), #071018);
            color: var(--footer-text);
            padding: 36px 20px;
            margin-top: 36px;
            border-top: 4px solid rgba(255,255,255,0.03);
        }
        .footer-container { max-width: 1300px; margin: 0 auto; display: flex; gap: 24px; align-items: flex-start; flex-wrap: wrap; }
        .footer-column { flex: 1 1 220px; min-width: 220px; }
        .footer-brand { display:flex; align-items:center; gap:12px; margin-bottom:10px; }
        .footer-brand h3 { margin:0; color: white; font-size:1.1rem; }
        .footer-p { color: rgba(230,238,242,0.9); margin:8px 0 16px 0; font-size:.95rem; }

        .footer-links { display: grid; grid-template-columns: repeat(2, minmax(120px,1fr)); gap:8px; }
        .footer-links a { color: rgba(230,238,242,0.9); text-decoration: none; font-size: .95rem; display:block; padding:6px 4px; border-radius:6px; }
        .footer-links a:hover { background: rgba(255,255,255,0.03); transform: translateY(-2px); }

        .newsletter { display:flex; gap:8px; align-items:center; margin-top:8px; }
        .newsletter input[type="email"] { flex:1; padding:10px 12px; border-radius:8px; border: none; outline:none; }
        .newsletter button { padding:10px 14px; border-radius:8px; border:none; background:var(--footer-accent); color:#042022; font-weight:700; cursor:pointer; }

        .socials { display:flex; gap:10px; margin-top:12px; }
        .socials a { display:inline-flex; align-items:center; justify-content:center; width:40px; height:40px; border-radius:8px; background: rgba(255,255,255,0.03); color:var(--footer-text); text-decoration:none; transition: transform .15s, background .15s; }
        .socials a:hover { transform: translateY(-4px); background: rgba(14,165,164,0.13); }

        .footer-bottom { display:flex; justify-content:space-between; align-items:center; gap:12px; margin-top:22px; border-top:1px solid rgba(255,255,255,0.04); padding-top:18px; font-size:.92rem; color: rgba(230,238,242,0.8); flex-wrap:wrap; }
        .back-to-top { background: rgba(255,255,255,0.03); color: var(--footer-text); padding:8px 12px; border-radius:8px; cursor:pointer; border:none; }
        .footer-toggle { background: transparent; border:1px solid rgba(255,255,255,0.04); color: var(--footer-text); padding:8px 10px; border-radius:8px; cursor:pointer; }

        /* Responsive small screens: collapse link lists */
        .collapsible { cursor: pointer; display:flex; justify-content:space-between; align-items:center; gap:8px; }
        .collapsible + .collapsible-content { max-height: 200px; overflow:hidden; transition: max-height 0.25s ease; }
        @media (max-width:800px){
            .footer-links { grid-template-columns: repeat(1, minmax(120px,1fr)); }
        }
    </style>
    {% block head_extra %}{% endblock %}
</head>
<body>
    <div class="header">
        <h1>Distribuidora JS | Portal B2B üöÄ</h1>
        <div class="nav">
            <a href="/">Inicio/Cat√°logo</a>
            <a href="/clientes/registro">üë§ Registro Cliente</a>
            <a href="/empresas/registro">üè≠ Registro Proveedor</a>
            <a href="/productos/registro">üì¶ Registro Producto</a> <a href="/compras/registro">üõí Nueva Compra</a>
            <a href="/clientes/listado">Ver Registros</a>
            <a href="http://127.0.0.1:8000/docs" target="_blank">API Docs</a>
        </div>
    </div>
    <div class="container">
        {% block content %}{% endblock %}
    </div>

    <!-- FOOTER INTERACTIVO -->
    <footer class="site-footer" role="contentinfo" aria-label="Pie de p√°gina principal">
        <div class="footer-container">
            <div class="footer-column">
                <div class="footer-brand">
                    <img src="https://via.placeholder.com/48x48?text=JS" alt="Logo" style="border-radius:8px;">
                    <div>
                        <h3>Distribuidora JS</h3>
                        <div style="font-size:.95rem; color:rgba(230,238,242,0.85)">Importaci√≥n y distribuci√≥n B2B de tecnolog√≠a</div>
                    </div>
                </div>
                <p class="footer-p">Atenci√≥n al cliente y soporte t√©cnico. Trabajamos con proveedores verificados y entregas seguras.</p>

                <div>
                    <div style="font-weight:600; margin-bottom:6px;">Suscr√≠bete al newsletter</div>
                    <div class="newsletter" role="form" aria-label="Suscripci√≥n bolet√≠n">
                        <input id="newsletterEmail" type="email" placeholder="tu@email.com" aria-label="Email">
                        <button id="newsletterBtn">Suscribirse</button>
                    </div>
                    <div id="newsletterMsg" style="margin-top:8px; font-size:.92rem;"></div>
                </div>
            </div>

            <div class="footer-column" aria-hidden="false">
                <div class="collapsible" onclick="toggleCollapse('linksGroup')">
                    <strong>Enlaces r√°pidos</strong>
                    <span id="caret-links">‚ñæ</span>
                </div>
                <div id="linksGroup" class="collapsible-content" style="max-height:300px;">
                    <div class="footer-links" role="navigation" aria-label="Enlaces r√°pidos">
                        <a href="/productos">Cat√°logo</a>
                        <a href="/compras/registro">Nueva Compra</a>
                        <a href="/dashboard">Dashboard</a>
                        <a href="/clientes/listado">Clientes</a>
                        <a href="/empresas/listado">Proveedores</a>
                        <a href="/productos/registro">Registrar Producto</a>
                    </div>
                </div>

                <div style="margin-top:16px;">
                    <div class="collapsible" onclick="toggleCollapse('contactGroup')">
                        <strong>Contacto</strong> <span id="caret-contact">‚ñæ</span>
                    </div>
                    <div id="contactGroup" class="collapsible-content" style="max-height: 200px;">
                        <div style="margin-top:8px;">
                            <div style="font-size:.95rem">üìß soporte@distribuidorajsv.com</div>
                            <div style="font-size:.95rem; margin-top:6px;">üìû +57 300 123 4567</div>
                            <div style="font-size:.95rem; margin-top:6px;">üè¢ Bogot√°, Colombia</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="footer-column" style="min-width:260px;">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <strong>Redes y soporte</strong>
                    <button class="footer-toggle" id="themeToggle" aria-pressed="false" title="Cambiar tema">Tema</button>
                </div>

                <p class="footer-p" style="margin-top:8px;">S√≠guenos para ofertas y actualizaciones</p>
                <div class="socials" role="navigation" aria-label="Redes sociales">
                    <a href="#" title="Instagram" aria-label="Instagram">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5z" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/><circle cx="12" cy="12" r="3.2" stroke="currentColor" stroke-width="1.4"/></svg>
                    </a>
                    <a href="#" title="Facebook" aria-label="Facebook">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18 2h-3a4 4 0 0 0-4 4v3H8v4h3v7h4v-7h3l1-4h-4V6a1 1 0 0 1 1-1h3z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </a>
                    <a href="#" title="LinkedIn" aria-label="LinkedIn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-14h4v2a4 4 0 0 1 4-2zM2 9h4v13h-4zM4 3a2 2 0 1 1 0 4 2 2 0 0 1 0-4z" stroke="currentColor" stroke-width="0.9" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </a>
                </div>

                <div style="margin-top:14px;">
                    <strong>Horario</strong>
                    <div style="color:rgba(230,238,242,0.85); margin-top:6px;">Lun - Vie: 8:00 - 18:00</div>
                </div>
            </div>
        </div>

        <div class="footer-container" style="margin-top:18px;">
            <div class="footer-bottom" style="width:100%;">
                <div>¬© <span id="footerYear"></span> Distribuidora JS. Todos los derechos reservados.</div>
                <div style="display:flex; gap:10px; align-items:center;">
                    <button class="back-to-top" id="backToTopBtn" aria-label="Volver arriba">‚Üë Subir</button>
                    <a href="/politica-privacidad" style="color:rgba(230,238,242,0.8); text-decoration:none;">Pol√≠tica de privacidad</a>
                    <a href="/terminos" style="color:rgba(230,238,242,0.8); text-decoration:none;">T√©rminos</a>
                </div>
            </div>
        </div>
    </footer>

    {% block scripts %}{% endblock %}

    <script>
        // Script del Footer: interacciones y accesibilidad
        (function(){
            // A√±o din√°mico
            document.getElementById('footerYear').textContent = new Date().getFullYear();

            // Collapsible simple (accesible)
            window.toggleCollapse = function(id){
                try {
                    const el = document.getElementById(id);
                    const caret = id === 'linksGroup' ? document.getElementById('caret-links') : document.getElementById('caret-contact');
                    if (!el) return;
                    // Toggle maxHeight para animaci√≥n
                    if (!el.style.maxHeight || el.style.maxHeight === '0px') {
                        el.style.maxHeight = el.scrollHeight + 'px';
                        if (caret) caret.textContent = '‚ñ¥';
                    } else {
                        el.style.maxHeight = '0px';
                        if (caret) caret.textContent = '‚ñæ';
                    }
                } catch(e) { console.warn(e); }
            };

            // Suscripci√≥n al newsletter (demo): POST a /newsletter/subscribe
            document.getElementById('newsletterBtn').addEventListener('click', async function(){
                const emailInput = document.getElementById('newsletterEmail');
                const msgEl = document.getElementById('newsletterMsg');
                const email = (emailInput.value || '').trim();
                msgEl.style.color = '#ffd966';

                if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                    msgEl.textContent = 'Ingresa un correo v√°lido.';
                    msgEl.style.color = '#ff6b6b';
                    return;
                }

                msgEl.textContent = 'Enviando...';

                try {
                    // Cambia la ruta seg√∫n tu backend; aqu√≠ se usa POST /newsletter/subscribe (relative)
                    const res = await fetch('/newsletter/subscribe', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email })
                    });

                    if (res.ok) {
                        msgEl.style.color = '#8ce99a';
                        msgEl.textContent = '¬°Gracias! Te hemos suscrito.';
                        emailInput.value = '';
                    } else {
                        const j = await res.json().catch(()=>({detail:'Error'}));
                        msgEl.style.color = '#ffb4a2';
                        msgEl.textContent = j.detail || 'No se pudo suscribir, intenta m√°s tarde.';
                    }
                } catch (err) {
                    msgEl.style.color = '#ffb4a2';
                    msgEl.textContent = 'Error de conexi√≥n. Intenta de nuevo.';
                    console.warn(err);
                }
            });

            // Back to top
            document.getElementById('backToTopBtn').addEventListener('click', function(){
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            // Simple theme toggle: cambia metadatos de color (persistente con localStorage)
            const themeToggle = document.getElementById('themeToggle');
            function applyTheme(theme){
                if (theme === 'dark') {
                    document.documentElement.style.setProperty('--color-fondo', '#071018');
                    document.documentElement.style.setProperty('--color-texto', '#dceff0');
                } else {
                    document.documentElement.style.setProperty('--color-fondo', '#f8f9fa');
                    document.documentElement.style.setProperty('--color-texto', '#333');
                }
                themeToggle.setAttribute('aria-pressed', theme === 'dark');
            }
            // Inicializar
            const saved = localStorage.getItem('site-theme') || 'light';
            applyTheme(saved);
            themeToggle.addEventListener('click', function(){
                const current = localStorage.getItem('site-theme') || 'light';
                const next = current === 'light' ? 'dark' : 'light';
                localStorage.setItem('site-theme', next);
                applyTheme(next);
            });

            // Accesibilidad: permitir colapsibles con Enter/Space (soporte teclado)
            document.querySelectorAll('.collapsible').forEach(el=>{
                el.setAttribute('tabindex', '0');
                el.addEventListener('keydown', (e)=>{
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        el.click();
                    }
                });
            });

            // Cierra colapsibles en mobile por defecto
            if (window.innerWidth < 800) {
                document.getElementById('linksGroup').style.maxHeight = '0px';
                document.getElementById('contactGroup').style.maxHeight = '0px';
            }
        })();
    </script>
</body>
</html>